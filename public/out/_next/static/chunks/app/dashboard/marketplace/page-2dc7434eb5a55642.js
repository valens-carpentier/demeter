(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[957],{13039:(e,a,t)=>{Promise.resolve().then(t.bind(t,40923))},40923:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>S});var s=t(95155),l=t(12115),n=t(76046),r=t(63592),c=t(10810),i=t(96854),o=t(70152),d=t(11441),m=t(91888),u=t(35417),x=t(64665),h=t(42479),p=t(2241),A=t(66656),j=t(22282),f=t(30353),y=t(88209),g=t(87597),k=t(63879),_=t(15108),v=t(51059),N=t.n(v),C=t(88968);function S(){let e=(0,l.useContext)(_.r),a=(0,l.useContext)(_.y),t=(0,n.useRouter)(),[v,S]=(0,l.useState)([]),[b,w]=(0,l.useState)([]),[L,T]=(0,l.useState)(!0),[I,z]=(0,l.useState)(""),[V,E]=(0,l.useState)("valuation-high"),[P,B]=(0,l.useState)(null),[D,F]=(0,l.useState)(""),[R,O]=(0,l.useState)(!1),[U,G]=(0,l.useState)(!1),[M,Q]=(0,l.useState)("");(0,l.useEffect)(()=>{a&&t.push("/dashboard/marketplace?passkeyId=".concat(a.rawId))},[a,t]),(0,l.useEffect)(()=>{(async()=>{try{let e=await (0,k.A)();S(e),w(e)}catch(e){console.error("Error loading farms:",e)}finally{T(!1)}})()},[]),(0,l.useEffect)(()=>{let e=[...v].filter(e=>e.isActive);I&&(e=e.filter(e=>e.name.toLowerCase().includes(I.toLowerCase()))),e.sort((e,a)=>{switch(V){case"valuation-high":return a.valuation-e.valuation;case"valuation-low":return e.valuation-a.valuation;case"expected-high":return a.sizeInAcres-e.sizeInAcres;case"expected-low":return e.sizeInAcres-a.sizeInAcres;default:return 0}}),w(e)},[v,I,V]);let H=e=>{B(e),G(!0)},W=async()=>{if(P&&e&&D&&a)try{O(!0);let t=parseInt(D),s=await (0,C.Q)(P.token,e,t,a);Q(s)}catch(e){console.error("Failed to buy tokens:",e),alert(e instanceof Error?e.message:"Failed to buy tokens. Please try again."),G(!1)}finally{O(!1)}};return L?(0,s.jsxs)(r.A,{className:N().marketplaceContainer,children:[(0,s.jsx)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:(0,s.jsx)(c.A,{variant:"h4",className:N().marketplaceTitle,children:"Marketplace"})}),(0,s.jsxs)(r.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px",flexDirection:"column",gap:2},children:[(0,s.jsx)(i.A,{size:60}),(0,s.jsx)(c.A,{variant:"body1",color:"text.secondary",children:"Loading farms..."})]})]}):(0,s.jsxs)(r.A,{className:N().marketplaceContainer,sx:{padding:3},children:[(0,s.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[(0,s.jsx)(c.A,{variant:"h4",className:N().marketplaceTitle,children:"Marketplace"}),(0,s.jsxs)(c.A,{color:"text.secondary",children:[b.length," farms available"]})]}),(0,s.jsxs)(r.A,{sx:{mb:4,display:"flex",gap:2},children:[(0,s.jsx)(o.A,{placeholder:"Search farms...",value:I,onChange:e=>z(e.target.value),sx:{flex:1},InputProps:{startAdornment:(0,s.jsx)(d.A,{position:"start",children:(0,s.jsx)(f.A,{})})}}),(0,s.jsxs)(o.A,{select:!0,value:V,onChange:e=>E(e.target.value),sx:{width:200},InputProps:{startAdornment:(0,s.jsx)(d.A,{position:"start",children:(0,s.jsx)(y.A,{})})},children:[(0,s.jsx)(m.A,{value:"valuation-high",children:"Highest Valuation"}),(0,s.jsx)(m.A,{value:"valuation-low",children:"Lowest Valuation"}),(0,s.jsx)(m.A,{value:"expected-high",children:"Largest Size"}),(0,s.jsx)(m.A,{value:"expected-low",children:"Smallest Size"})]})]}),(0,s.jsx)(u.Ay,{container:!0,spacing:3,sx:{display:"flex",justifyContent:"center",maxWidth:"1000px",margin:"0 auto"},children:b.map((a,t)=>(0,s.jsx)(u.Ay,{item:!0,xs:12,sm:12,md:6,lg:6,sx:{display:"flex",justifyContent:"center"},children:(0,s.jsx)(x.A,{className:N().farmCard,children:(0,s.jsxs)(h.A,{children:[(0,s.jsx)(c.A,{variant:"h6",className:N().farmName,children:a.name}),(0,s.jsxs)(r.A,{sx:{my:2},children:[(0,s.jsxs)("div",{className:N().farmStat,children:[(0,s.jsx)(c.A,{color:"text.secondary",className:N().statLabel,children:"Farm Size"}),(0,s.jsxs)(c.A,{variant:"h6",className:N().statValue,children:[a.sizeInAcres," acres"]})]}),(0,s.jsx)(p.A,{sx:{my:1.5}}),(0,s.jsxs)("div",{className:N().farmStat,children:[(0,s.jsx)(c.A,{color:"text.secondary",className:N().statLabel,children:"Farm Valuation"}),(0,s.jsxs)(c.A,{variant:"h6",className:N().statValue,children:["$",a.valuation.toLocaleString()]})]}),(0,s.jsx)(p.A,{sx:{my:1.5}}),(0,s.jsxs)("div",{className:N().farmStat,children:[(0,s.jsx)(c.A,{color:"text.secondary",className:N().statLabel,children:"Token Price"}),(0,s.jsxs)(c.A,{variant:"h6",className:"".concat(N().statValue," ").concat(N().highlight),children:["$",a.pricePerToken]})]}),(0,s.jsx)(p.A,{sx:{my:1.5}}),(0,s.jsxs)("div",{className:N().farmStat,children:[(0,s.jsx)(c.A,{color:"text.secondary",className:N().statLabel,children:"Expected Annual Valuation Growth"}),(0,s.jsxs)(c.A,{variant:"h6",className:"".concat(N().statValue," ").concat(N().success),children:[a.expectedOutcomePercentage,"%"]})]}),(0,s.jsx)(p.A,{sx:{my:1.5}}),(0,s.jsxs)("div",{className:N().farmStat,children:[(0,s.jsx)(c.A,{color:"text.secondary",className:N().statLabel,children:"Total Supply"}),(0,s.jsxs)(c.A,{variant:"h6",className:N().statValue,children:[a.totalTokenSupply.toLocaleString()," tokens"]})]}),(0,s.jsx)(p.A,{sx:{my:1.5}}),(0,s.jsxs)("div",{className:N().farmStat,children:[(0,s.jsx)(c.A,{color:"text.secondary",className:N().statLabel,children:"Token Address"}),(0,s.jsx)(A.A,{href:"https://sepolia.basescan.org/address/".concat(a.token),target:"_blank",rel:"noopener noreferrer",style:{textDecoration:"none"},children:(0,s.jsx)(c.A,{variant:"h6",className:N().statValue,sx:{fontSize:"0.8rem","&:hover":{textDecoration:"underline"}},children:"".concat(a.token.slice(0,6),"...").concat(a.token.slice(-6))})})]})]}),(0,s.jsx)(j.A,{variant:"contained",fullWidth:!0,className:N().buyButton,disabled:!a.isActive||!e,onClick:()=>H(a),children:e?a.isActive?"Buy":"Sold Out":"Connecting Safe..."})]})})},t))}),0===b.length&&(0,s.jsx)(c.A,{className:N().noResults,children:"No farms match your search criteria."}),(0,s.jsx)(g.A,{open:U,onClose:()=>{G(!1),Q(""),F("")},selectedFarm:{name:(null==P?void 0:P.name)||"",token:(null==P?void 0:P.token)||"",pricePerToken:(null==P?void 0:P.pricePerToken)||0},buyAmount:D,onBuyAmountChange:e=>F(e),onBuyConfirm:W,isBuying:R,transactionHash:M})]})}},51059:e=>{e.exports={marketplaceContainer:"marketplace_marketplaceContainer__2BwNL",marketplaceTitle:"marketplace_marketplaceTitle__3LGXC",farmCard:"marketplace_farmCard__0uZJf",farmName:"marketplace_farmName__7m52e",farmStat:"marketplace_farmStat__bgaEp",statLabel:"marketplace_statLabel__lYUGU",statValue:"marketplace_statValue__5C1zg",highlight:"marketplace_highlight__fKDMx",success:"marketplace_success__40TRp",buyButton:"marketplace_buyButton__dkyzw",noResults:"marketplace_noResults__LUDrC",loadingContainer:"marketplace_loadingContainer__jmQYQ",loadingText:"marketplace_loadingText__LUDn_"}}},e=>{var a=a=>e(e.s=a);e.O(0,[502,49,770,12,320,683,488,944,581,905,9,240,574,431,441,517,358],()=>a(13039)),_N_E=e.O()}]);