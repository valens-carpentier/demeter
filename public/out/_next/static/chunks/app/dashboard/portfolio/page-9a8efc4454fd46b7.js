(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[354],{68210:(e,l,s)=>{Promise.resolve().then(s.bind(s,67503))},67503:(e,l,s)=>{"use strict";s.r(l),s.d(l,{default:()=>A});var a=s(95155),o=s(12115),n=s(15108),t=s(35849),r=s(76046),i=s(72248),c=s.n(i),d=s(63592),_=s(10810),u=s(22282),h=s(96854),m=s(55563),p=s(88968),x=s(59811),f=s(67396),j=s(9002),N=s.n(j);function C(e){let{open:l,onClose:s,holding:n,safeAddress:t,passkey:r}=e,[i,c]=(0,o.useState)(""),[j,C]=(0,o.useState)(!1),[k,A]=(0,o.useState)(""),M=async()=>{if(n&&t&&i&&r)try{C(!0);let e=parseInt(i),l=await (0,p.u)(n.tokenAddress,t,e,r);A(l)}catch(e){console.error("Failed to sell tokens:",e),alert(e.message||"Failed to sell tokens. Please try again.")}finally{C(!1)}};return(0,a.jsx)(m.A,{open:l,onClose:j||k?void 0:s,"aria-labelledby":"sell-token-modal",children:(0,a.jsx)(d.A,{className:N().sellModal,children:k?(0,a.jsxs)(d.A,{className:N().transactionSuccessContainer,children:[(0,a.jsx)(x.A,{className:N().successIcon}),(0,a.jsx)(_.A,{variant:"h6",sx:{textAlign:"center"},children:"Transaction Successful!"}),(0,a.jsx)(_.A,{variant:"body2",color:"text.secondary",sx:{textAlign:"center"},children:"Your sale has been confirmed. You can view the transaction details below:"}),(0,a.jsx)(f.default,{href:"https://jiffyscan.xyz/userOpHash/".concat(k,"?network=base-sepolia"),target:"_blank",rel:"noopener noreferrer",className:N().transactionLink,children:k}),(0,a.jsx)(u.A,{variant:"contained",onClick:s,className:N().sellButton,children:"Close"})]}):j?(0,a.jsxs)(d.A,{className:N().processingContainer,children:[(0,a.jsx)(h.A,{size:48,className:N().processingSpinner}),(0,a.jsx)(_.A,{variant:"h6",children:"Processing Transaction"}),(0,a.jsx)(_.A,{variant:"body2",color:"text.secondary",children:"Please wait while we process your sale..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(_.A,{className:N().sellModalTitle,children:"Sell"}),(0,a.jsxs)(d.A,{className:N().sellModalContent,children:[(0,a.jsxs)(d.A,{className:N().sellModalRow,children:[(0,a.jsx)(_.A,{className:N().sellModalLabel,children:"Current Balance:"}),(0,a.jsx)(_.A,{className:N().sellModalValue,children:(null==n?void 0:n.tokenBalance)||0})]}),(0,a.jsxs)(d.A,{className:N().sellModalRow,children:[(0,a.jsx)(_.A,{className:N().sellModalLabel,children:"Token Price:"}),(0,a.jsxs)(_.A,{className:N().sellModalValue,children:["$",(null==n?void 0:n.tokenPrice)||0]})]}),(0,a.jsxs)(d.A,{className:N().sellModalRow,children:[(0,a.jsx)(_.A,{className:N().sellModalLabel,children:"Number of Tokens:"}),(0,a.jsxs)(d.A,{className:N().sellModalCounter,children:[(0,a.jsx)(u.A,{size:"small",className:N().counterButton,onClick:()=>c(String(Math.max(0,Number(i||0)-1))),children:"-"}),(0,a.jsx)(_.A,{className:N().sellModalValue,children:i||"0"}),(0,a.jsx)(u.A,{size:"small",className:N().counterButton,onClick:()=>c(String(Math.min((null==n?void 0:n.tokenBalance)||0,Number(i||0)+1))),children:"+"})]})]}),(0,a.jsxs)(d.A,{className:N().sellModalRow,children:[(0,a.jsx)(_.A,{className:N().sellModalLabel,children:"Total Value:"}),(0,a.jsxs)(_.A,{className:N().sellModalValue,children:["$",n&&i?(n.tokenPrice*Number(i)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2}):"0.00"]})]})]}),(0,a.jsx)(d.A,{sx:{mt:2},children:(0,a.jsx)(u.A,{fullWidth:!0,variant:"contained",className:"".concat(N().sellButton," ").concat(N().usdcButton),onClick:M,disabled:j||!i||1>parseInt(i)||parseInt(i)>((null==n?void 0:n.tokenBalance)||0),children:"Proceed"})})]})})})}var k=s(87597);function A(){let e=(0,o.useContext)(n.r),l=(0,o.useContext)(n.y),s=(0,r.useRouter)(),[i,d]=(0,o.useState)([]),[_,u]=(0,o.useState)(!0),[h,m]=(0,o.useState)(!1),[x,f]=(0,o.useState)(!1),[j,N]=(0,o.useState)(null),[A,M]=(0,o.useState)(""),[g,b]=(0,o.useState)(!1),[S,v]=(0,o.useState)("");(0,o.useEffect)(()=>{l&&s.push("/dashboard/portfolio?passkeyId=".concat(l.rawId))},[l,s]),(0,o.useEffect)(()=>{(async()=>{if(e)try{let l=await (0,t.I)(e);d(l)}catch(e){console.error("Error fetching portfolio data:",e)}finally{u(!1)}})()},[e]);let w=e=>{N(e),m(!0)},y=e=>{N(e),f(!0)},B=async()=>{if(j&&e&&A&&l)try{b(!0);let s=parseInt(A),a=await (0,p.Q)(j.tokenAddress,e,s,l);v(a)}catch(e){console.error("Failed to buy tokens:",e),alert(e instanceof Error?e.message:"Failed to buy tokens. Please try again."),f(!1)}finally{b(!1)}};return(0,a.jsxs)("div",{className:c().portfolioContainer,children:[(0,a.jsx)("h1",{className:c().portfolioTitle,children:"Portfolio"}),(0,a.jsx)("h2",{className:c().title,children:"Wallets"}),(0,a.jsx)("div",{className:c().walletCard,children:(0,a.jsxs)("div",{className:c().walletContainer,children:[_?(0,a.jsxs)("div",{className:c().loadingContainer,children:[(0,a.jsx)("div",{className:c().spinner}),(0,a.jsx)("span",{className:c().walletAddress,children:"Loading address..."})]}):(0,a.jsxs)("span",{className:c().walletAddress,children:["Base Sepolia: ",e]}),(0,a.jsxs)("div",{className:c().walletLinks,children:[(0,a.jsx)("a",{href:"https://app.safe.global/base-sepolia:".concat(e),target:"_blank",rel:"noopener noreferrer",className:c().walletLink,children:"Link to Safe Wallet"}),(0,a.jsx)("div",{className:c().divider}),(0,a.jsx)("a",{href:"https://sepolia.basescan.org/address/".concat(e),target:"_blank",rel:"noopener noreferrer",className:c().walletLink,children:"Link to Base Scan"})]})]})}),(0,a.jsx)("h2",{className:c().title,children:"Your Holdings"}),(0,a.jsxs)("div",{className:c().assetsCard,children:[(0,a.jsxs)("div",{className:c().assetsHeader,children:[(0,a.jsx)("span",{className:c().headerCell,children:"Farm Name"}),(0,a.jsx)("span",{className:c().headerCell,children:"Token Price"}),(0,a.jsx)("span",{className:c().headerCell,children:"Number of Tokens"}),(0,a.jsx)("span",{className:c().headerCell,children:"Your Holdings"}),(0,a.jsx)("span",{className:c().headerCell})]}),_?(0,a.jsx)("div",{className:c().loadingContainer,children:(0,a.jsx)("div",{className:c().spinner})}):i.length>0?i.map((e,l)=>(0,a.jsxs)("div",{className:c().assetRow,children:[(0,a.jsx)("span",{className:c().assetCell,children:e.farmName}),(0,a.jsxs)("span",{className:c().assetCell,children:["$",e.tokenPrice]}),(0,a.jsx)("span",{className:"".concat(c().assetCell," ").concat(c().tokenBalance),children:e.tokenBalance}),(0,a.jsxs)("span",{className:"".concat(c().assetCell," ").concat(c().holdingsValue),children:["$",e.userShare.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})]}),(0,a.jsxs)("div",{className:c().buttonContainer,children:[(0,a.jsx)("button",{className:c().sellButton,onClick:()=>w(e),children:"Sell"}),(0,a.jsx)("button",{className:c().buyButton,onClick:()=>y(e),children:"Buy"})]})]},l)):(0,a.jsx)("p",{className:c().noAssetsMessage,children:"No assets found in your portfolio"})]}),(0,a.jsx)(k.A,{open:x,onClose:()=>{f(!1),v(""),M("")},selectedFarm:{name:(null==j?void 0:j.farmName)||"",token:(null==j?void 0:j.tokenAddress)||"",pricePerToken:(null==j?void 0:j.tokenPrice)||0},buyAmount:A,onBuyAmountChange:e=>M(e),onBuyConfirm:B,isBuying:g,transactionHash:S}),(0,a.jsx)(C,{open:h,onClose:()=>m(!1),holding:j,safeAddress:e||"",passkey:l})]})}},59811:(e,l,s)=>{"use strict";var a=s(9493);l.A=void 0;var o=a(s(84758)),n=s(95155);l.A=(0,o.default)((0,n.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"}),"CheckCircle")},9002:e=>{e.exports={sellModal:"SellModal_sellModal__kex1_",sellModalTitle:"SellModal_sellModalTitle__6aQRU",sellModalContent:"SellModal_sellModalContent__qn04z",sellModalRow:"SellModal_sellModalRow__dbbXW",sellModalLabel:"SellModal_sellModalLabel__LaHm4",sellModalValue:"SellModal_sellModalValue__lBFmr",sellModalCounter:"SellModal_sellModalCounter__jJz7L",counterButton:"SellModal_counterButton__hLsO3",sellButton:"SellModal_sellButton__nVhh3",usdcButton:"SellModal_usdcButton__GmaAD",transactionSuccessContainer:"SellModal_transactionSuccessContainer__uJc_w",successIcon:"SellModal_successIcon__NfHfe",transactionLink:"SellModal_transactionLink__oB0Ep",processingContainer:"SellModal_processingContainer__fUEPT",processingSpinner:"SellModal_processingSpinner__tPlGt"}},72248:e=>{e.exports={portfolioContainer:"portfolio_portfolioContainer__SieP_",portfolioTitle:"portfolio_portfolioTitle__l9ujD",walletCard:"portfolio_walletCard__iq8iJ",walletContainer:"portfolio_walletContainer__15aEP",walletAddress:"portfolio_walletAddress__XWh_X",walletLinks:"portfolio_walletLinks___6AzV",walletLink:"portfolio_walletLink__J304A",assetsCard:"portfolio_assetsCard__iyhbR",assetsHeader:"portfolio_assetsHeader__rIgtX",headerCell:"portfolio_headerCell__0QX00",assetRow:"portfolio_assetRow__pQR_D",assetCell:"portfolio_assetCell__WzVy6",tokenPrice:"portfolio_tokenPrice__szBhr",tokenBalance:"portfolio_tokenBalance__y6Ry0",holdingsValue:"portfolio_holdingsValue__okBy6",noAssetsMessage:"portfolio_noAssetsMessage__Gxxf2",divider:"portfolio_divider__5oyEJ",title:"portfolio_title__mqtpb",buttonContainer:"portfolio_buttonContainer__5c_p3",sellButton:"portfolio_sellButton__UYoAW",buyButton:"portfolio_buyButton__E8CQY",loadingContainer:"portfolio_loadingContainer__8kZ9s",spinner:"portfolio_spinner__bMi5t",spin:"portfolio_spin__CsBx3"}}},e=>{var l=l=>e(e.s=l);e.O(0,[502,49,770,12,320,683,488,944,316,574,431,849,441,517,358],()=>l(68210)),_N_E=e.O()}]);