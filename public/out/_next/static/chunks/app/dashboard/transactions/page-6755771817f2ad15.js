(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[563],{16069:(e,t,n)=>{Promise.resolve().then(n.bind(n,50513))},50513:(e,t,n)=>{"use strict";n.r(t),n.d(t,{default:()=>T});var a=n(95155),s=n(12115),r=n(63592),o=n(10810),i=n(96854),c=n(22282),l=n(12406),d=n(78562),h=n(47335),u=n(27315),f=n(18786),x=n(48983),j=n(79283),p=n(2432),A=n(66656),m=n(15108),w=n(52316),g=n(98982),b=n(53647),k=n(65494),y=n(63879);async function _(e){if(!e)return[];try{let a=await (0,y.A)(),s=await fetch("".concat("https://safe-transaction-base-sepolia.safe.global/api","/v1/safes/").concat(e,"/all-transactions/"));if(!s.ok)throw Error("Safe API error: ".concat(s.statusText));let r=await s.json(),o=[],i=new Set,c=new Map(a.map(e=>[e.token.toLowerCase(),e.name]));for(let a of r.results||[])try{var t,n;if(i.has(a.transactionHash))continue;let s=!1;if(a.transfers)for(let n of a.transfers){let r=n.to.toLowerCase(),l=c.get(r);if(l){let d=n.from.toLowerCase()===e.toLowerCase()?"buy":"sell",h=a.transfers.find(e=>{var t;return e.tokenInfo&&c.has(null===(t=e.tokenInfo.address)||void 0===t?void 0:t.toLowerCase())});if(h){let e=(null===(t=h.tokenInfo)||void 0===t?void 0:t.decimals)||6,n=Number(w.Js(h.value,e)),c=new g.NZ(r,["function pricePerToken() view returns (uint256)"],new b.FR(k.E0)),u=await c.pricePerToken(),f=Number(u);o.push({farmName:l,date:a.executionDate,amount:n,hash:a.transactionHash,type:"buy"===d?"Buy":"Sell",price:f}),i.add(a.transactionHash),s=!0;break}}}if(!s&&Array.from(c.keys()).includes(a.to.toLowerCase())){let t=c.get(a.to.toLowerCase());if(t){let s="buy",r=0;if(a.transfers){let t=a.transfers.find(e=>{var t;return e.tokenInfo&&c.has(null===(t=e.tokenInfo.address)||void 0===t?void 0:t.toLowerCase())});if(t){let o=(null===(n=t.tokenInfo)||void 0===n?void 0:n.decimals)||6;r=Number(w.Js(t.value,o)),t.from.toLowerCase()===e.toLowerCase()&&t.to.toLowerCase()!==a.to.toLowerCase()&&(s="sell")}}let l=new g.NZ(a.to,["function pricePerToken() view returns (uint256)"],new b.FR(k.E0)),d=await l.pricePerToken(),h=Number(d);o.push({farmName:t,date:a.executionDate,amount:r,hash:a.transactionHash,type:"buy"===s?"Buy":"Sell",price:h}),i.add(a.transactionHash)}}}catch(e){console.error("Error processing transaction:",e);continue}return o.sort((e,t)=>new Date(t.date).getTime()-new Date(e.date).getTime())}catch(e){return console.error("Error loading transactions:",e),[]}}var v=n(76046),C=n(56080),N=n.n(C);function T(){let[e,t]=(0,s.useState)([]),[n,w]=(0,s.useState)(!0),g=(0,s.useContext)(m.y),b=(0,v.useRouter)(),k=(0,s.useContext)(m.r),[y,C]=(0,s.useState)([]);(0,s.useEffect)(()=>{g&&b.push("/dashboard/transactions?passkeyId=".concat(g.rawId))},[g,b]),(0,s.useEffect)(()=>{(async()=>{try{let e=await _(k||"");t(e)}catch(e){console.error("Error loading transactions:",e)}finally{w(!1)}})()},[k]);let T=e=>{let t=y.indexOf(e);C(-1===t?[...y,e]:y.filter(t=>t!==e))};return n?(0,a.jsxs)(r.A,{className:N().transactionContainer,children:[(0,a.jsx)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:(0,a.jsx)(o.A,{className:N().transactionTitle,variant:"h4",children:"Transactions"})}),(0,a.jsxs)(r.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"300px",flexDirection:"column",gap:2},children:[(0,a.jsx)(i.A,{size:60}),(0,a.jsx)(o.A,{variant:"body1",color:"text.secondary",children:"Loading transactions..."})]})]}):(0,a.jsxs)(r.A,{className:N().transactionContainer,children:[(0,a.jsxs)(r.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:4},children:[(0,a.jsx)(o.A,{className:N().transactionTitle,variant:"h4",children:"Transactions"}),(0,a.jsxs)(r.A,{sx:{display:"flex",gap:2},children:[(0,a.jsx)(c.A,{className:"".concat(N().transactionButton," ").concat(N().outlined),variant:"outlined",disabled:!0,children:"Filter"}),(0,a.jsx)(c.A,{className:"".concat(N().transactionButton," ").concat(N().outlined),variant:"outlined",disabled:!0,children:"Export"})]})]}),(0,a.jsx)(l.A,{component:d.A,className:N().transactionTable,children:(0,a.jsxs)(h.A,{children:[(0,a.jsx)(u.A,{children:(0,a.jsxs)(f.A,{children:[(0,a.jsx)(x.A,{padding:"checkbox",children:(0,a.jsx)(j.A,{checked:y.length===e.length,onChange:t=>{t.target.checked?C(e.map(e=>e.hash)):C([])}})}),(0,a.jsx)(x.A,{children:"Type"}),(0,a.jsx)(x.A,{children:"Number of Tokens"}),(0,a.jsx)(x.A,{children:"Price"}),(0,a.jsx)(x.A,{children:"Farm"}),(0,a.jsx)(x.A,{children:"Transaction Details"}),(0,a.jsx)(x.A,{children:"Date"}),(0,a.jsx)(x.A,{})]})}),(0,a.jsx)(p.A,{children:e.map(e=>(0,a.jsxs)(f.A,{children:[(0,a.jsx)(x.A,{padding:"checkbox",children:(0,a.jsx)(j.A,{checked:y.includes(e.hash),onChange:()=>T(e.hash)})}),(0,a.jsx)(x.A,{children:e.type}),(0,a.jsx)(x.A,{children:e.amount}),(0,a.jsxs)(x.A,{children:["$",(e.price*e.amount/100).toFixed(2)]}),(0,a.jsx)(x.A,{children:e.farmName}),(0,a.jsx)(x.A,{children:(0,a.jsx)(A.A,{href:"https://sepolia.basescan.org/tx/".concat(e.hash),target:"_blank",rel:"noopener noreferrer",className:N().transactionLink,children:"".concat(e.hash.slice(0,6),"...").concat(e.hash.slice(-4))})}),(0,a.jsx)(x.A,{children:new Date(e.date).toLocaleDateString()}),(0,a.jsx)(x.A,{align:"right"})]},e.hash))})]})}),0===e.length&&(0,a.jsx)(o.A,{className:N().noTransactionsMessage,children:"No transactions found."})]})}},56080:e=>{e.exports={transactionContainer:"transaction_transactionContainer__sFNH0",transactionTitle:"transaction_transactionTitle__xfOt9",transactionTable:"transaction_transactionTable__gQgBc",transactionButton:"transaction_transactionButton__kihBf",outlined:"transaction_outlined__iEhjO",noTransactionsMessage:"transaction_noTransactionsMessage__rLNeX",transactionLink:"transaction_transactionLink__wbhhn"}}},e=>{var t=t=>e(e.s=t);e.O(0,[703,49,770,488,316,805,574,441,517,358],()=>t(16069)),_N_E=e.O()}]);